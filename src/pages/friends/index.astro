---
import { NOTIFICATIONS_TYPES } from "../../const";
import FormsLayaout from "../../layouts/FormsLayaout.astro";
import { getFriends } from "../../utils/api";
import Notification from "../../components/ui/Notification";
import Card from "../../components/ui/Card.astro";

const token = Astro.cookies.get("trello_bff_token")?.value;
let data: any = {
  data: null,
  notification: {
    type: NOTIFICATIONS_TYPES.danger,
    text: "Ha sucedido un problema inesperado, int√©ntalo mas tarde",
    error: "",
  },
};
if (token) {
  data = await getFriends(token);
}
---

<FormsLayaout title="U-Trello">
  <slot name="notification">
    {
      data.notification.type && (
        <Notification
          type={data.notification.type}
          text={data.notification.text}
        />
      )
    }
  </slot>

  <div
    class="w-full h-auto p-4 flex flex-wrap sm:flex-nowrap sm:flex-row gap-4"
  >
    {
      data?.data.map((friend: any) => {
        return <Card src="" title={friend.email} />;
      })
    }
    <a
      href="/friends/add"
      class="w-60 h-80 flex flex-col items-center justify-center rounded-xl border border-dashed border-gray-600 truncate hover:scale-105 transition-all p-2"
    >
      <img src="/user-search.svg" alt="imagen de usuario" class="h-20 w-20" />
    </a>
  </div>
</FormsLayaout>
